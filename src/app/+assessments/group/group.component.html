<div id="assessmentsGroup">

    <div class="row">
        <div class="col-md-9">
            <h4>
                <!--<i class="material-icons">description</i>-->
                <img class="stix-icon" src="assets/icon/stix-icons/svg/report-b.svg"> &nbsp;Assessment: {{ assessment.attributes.name}}
            </h4>
        </div>
        <div class="col-md-3 text-right">
            <!-- TODO make date pipe -->
            <p class="headingMarginMatch text-muted">Published &bull; {{ assessment.attributes.created | date:'medium' }}</p>
        </div>
    </div>


    <div class="row" *ngIf="riskByAttackPattern && riskByAttackPattern.phases && riskByAttackPattern.phases.length" id="phaseListWrapper">

        <div class="col-sm-3">
            <h4>Kill Chain Phases</h4><br>
            <div *ngFor="let phase of riskByAttackPattern.phases">
                <p>
                    <a (click)="setPhase(phase._id)">{{ phase._id | capitalize }}</a> &bull; <span>{{ phase.avgRisk | percent:'2.1-1' }}</span>
                </p>
                <p class="text-muted">Attack Patterns &bull; {{ phase.scores.length }} / {{ getNumAttackPatterns(phase._id) }}</p>
            </div>
            <p><small>Unassessed Kill Chain Phases: {{ unassessedPhases | capitalize }}</small>
            </p>
        </div>

        <div class="col-sm-3">
            <h4>Attack Patterns</h4>
            <h4 class="text-muted">Phase:&nbsp;{{ activePhase | capitalize }}</h4>
            <div *ngFor="let score of getScores(activePhase)" class="attackPatternListItem">
                <span class="greyTextShadow"><i class="material-icons" [style.color]="getRiskColor(score.risk)">lens</i></span>&nbsp;
                <a (click)="setAttackPattern(score.attackPatternName)">{{ score.attackPatternName }}</a>
            </div>
        </div>

        <div class="col-sm-6">
            <div *ngIf="currentAttackPattern">
                <h4>{{ currentAttackPattern.name }}</h4>
                <p *ngIf="currentAttackPattern.kill_chain_phases && currentAttackPattern.kill_chain_phases.length > 0">Kill Chain Phases:</p>
                <ul *ngIf="currentAttackPattern.kill_chain_phases">
                    <li *ngFor="let killchain of currentAttackPattern.kill_chain_phases">{{ killchain.phase_name }}</li>
                </ul>
                <p *ngIf="currentAttackPattern.x_unfetter_sophistication_level !== undefined && currentAttackPattern.x_unfetter_sophistication_level !== null">Sophiciation Level: {{ currentAttackPattern.x_unfetter_sophistication_level }}</p>
                <p *ngIf="currentAttackPattern.description">Description:<br> {{ currentAttackPattern.description }}</p>
                <div *ngIf="currentAttackPattern.external_references">
                    <p>External References:</p>
                    <p *ngFor="let ref of currentAttackPattern.external_references">
                        <a href="{{ ref.url }}" target="_blank">{{ ref.source_name }} <span *ngIf="ref.external_id">&bull; {{ ref.external_id }}</span></a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <hr>
    <p class="text-muted">
        <a routerLink="/assessments/dashboard/{{id}}">Dashboard View</a> &bull;
        <a routerLink="/assessments">Assessments Menu</a>
    </p>

</div>